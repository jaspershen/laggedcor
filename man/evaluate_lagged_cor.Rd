% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/9-evaluate_lagged_cor.R
\name{evaluate_lagged_cor}
\alias{evaluate_lagged_cor}
\title{Evaluate Lagged Correlation and Fit Peaks}
\usage{
evaluate_lagged_cor(object, plot = TRUE)
}
\arguments{
\item{object}{An object of class \code{lagged_cor_result} which contains the fields \code{all_cor} for
correlations and \code{shift_time} for the corresponding time shifts.}

\item{plot}{Logical; if \code{TRUE}, generates a plot of the actual versus fitted correlation data.
Defaults to \code{TRUE}.}
}
\value{
A list containing the following components:
\itemize{
\item \code{score}: A numeric value representing the Spearman correlation score
of the fit, where higher values indicate a better fit.
\item \code{plot}: A ggplot object showing the actual versus fitted correlation data
if \code{plot} is \code{TRUE}, otherwise \code{NULL}.
}
}
\description{
This function takes a lagged correlation object, fits a loess curve to the correlation data,
normalizes the data to ensure all correlations are on the same side of zero, fits peaks to the
normalized correlation data, computes a score based on the Spearman correlation between the fitted
peaks and the actual data, and optionally generates a plot.
}
\details{
The function starts by checking if the input object is \code{NULL}. If it is, it returns a score
of 0 and \code{NULL} for the plot. If the object is not \code{NULL}, the function proceeds to clean
and prepare the shift times using \code{stringr} and \code{purrr}. Then, it fits a loess model to
the correlation data and uses this to normalize the data and identify peaks using a custom
\code{fitpeaks} function. It calculates the score of the fit using Spearman's method. The peak with
the highest absolute correlation determines the score, and the function distinguishes between
positive and negative correlations. The function uses \code{ggplot2} for plotting if required.
}
\note{
This function depends on several external packages (\code{ggplot2}, \code{dplyr}, \code{stringr}, \code{purrr}) as
well as a custom \code{fitpeaks} function that must be defined elsewhere in the user's environment.
}
\examples{
data("object", package = "laggedcor")
result = 
  evaluate_lagged_cor(object = object, plot = TRUE)

result$score
result$plot
}
